$(document).ready(function(){(function(a){a.ElementManager={loadForm:function(){var b={formFilename:a.ElementManager.getFormFilename()};a(a.ZFM.selectors.sortableArea).html("");a.UserInterface.eraseBuildInfos();a.ajaxCalls.loadForm(b)},loadFormCallback:function(b){for(var c in b.elements){var d=b.elements[c];a.ElementManager.createElementCallback(d.el,d.id)}a.ElementManager.loadElementAttribs(b)},createElement:function(b,c){var d=a.ElementManager.getElementType(b),e=a.ElementManager.getFormFilename();
a.ajaxCalls.createElement({type:d,formFilename:e},c)},createElementCallback:function(b,c,d){b=a.ElementManager.buildSortableElement(b,c);d=="false"?a.ZFM.tmpSortableElement={el:b,id:c}:(a(a.ZFM.selectors.sortableArea).append(b),a.ElementManager.addCMSortableElement(c),a("."+a.ZFM.className.sortableElement+"_"+c).click(function(a){a.preventDefault();a.stopImmediatePropagation()}).effect("highlight"),(a("."+a.ZFM.className.sortableHandle+":hidden").length>0||a("."+a.ZFM.className.sortableHandle).length==
1)&&a("."+a.ZFM.className.sortableHandle).hide())},buildSortableElement:function(b,c){var d="";d+='<table id="orderid_'+c+'" class="'+a.ZFM.className.sortableElement+" "+a.ZFM.className.sortableElement+"_"+c+'">\r\n';d+="    <tbody>\r\n";d+="        <tr>\r\n";d+="            <td>";d+='                <div class="'+a.ZFM.className.sortableHandle+'">\r\n';d+="                </div>\r\n";d+="            </td>\r\n";d+='            <td class="'+a.ZFM.className.sortableElementPart+'" title="right click to display the context menu">\r\n';
d+="                "+b+"\r\n";d+="            </td>\r\n";d+="        </tr>\r\n";d+="    </tbody>\r\n";d+="</table>\r\n\r\n";return d},addCMSortableElement:function(b){a("."+a.ZFM.className.sortableElement+"_"+b).children().children().children("."+a.ZFM.className.sortableElementPart).contextMenu({menu:a.ZFM.contextMenu.edit},function(c,d){switch(c){case "edit":a.ElUpdateManager.getEditDialogDatas(b);break;case "delete":var e=d.parent().parent().parent();a.ElementManager.deleteElement(e)}})},deleteElement:function(b){var c=
a.ElementManager.getElementId(b),d=a.ElementManager.getFormFilename(),c={id:c,formFilename:d},d=a.ElementManager.getElementName(b);confirm("You're gonna delete the element named '"+d+"'. Are you sure ? ")&&a.ajaxCalls.deleteElement(c,b)},deleteElementCallback:function(b,c){b.effect("explode");b.remove();a(a.ZFM.selectors.editElementDialogForm).dialog("isOpen")&&a(a.ZFM.selectors.editElementDialogForm).dialog("close");a.Tools.showMessage("success",c.msg)},getElementId:function(b){return a.Tools.getDataInClass(b,
a.ZFM.className.sortableElement)},getElementType:function(b){return a.Tools.getDataInClass(b,"type")},getElementName:function(b){var b=a.ElementManager.getElementId(b),b="."+a.ZFM.className.sortableElement+"_"+b,c=a(b+" input");c.length==0&&(c=a(b+" select"),c.length==0&&(c=a(b+" textarea"),c.length==0&&(c=a(b+" button"))));c.attr("type");return name=c.attr("name")},getFormFilename:function(){return a(a.ZFM.selectors.formFilename).text()},initFormAttributes:function(){a("#formSettings #addAttributeButton").click(function(b){a.ElementManager.addAttributeButtonClick(b)});
a("#formSettings #attribValue").keyup(function(b){b.keyCode=="13"&&a.ElementManager.addAttributeButtonClick(b)});a("#formSettings #attribName").keyup(function(b){b.keyCode=="13"&&a.ElementManager.addAttributeButtonClick(b)})},loadElementAttribs:function(b){b=b.attribs;a.ElementManager.clearAttributes();if(typeof b!="undefined")for(var c in b)a.ElementManager.addEditAttribute(c,b[c])},addAttributeButtonClick:function(b){b.stopPropagation();b.stopImmediatePropagation();var c=a.ElementManager.getFormFilename(),
b=jQuery.trim(a("#formSettings #attributEditLine #attribName").val()),d=jQuery.trim(a("#formSettings #attributEditLine #attribValue").val()),c={formFilename:c,name:b,value:d};b.length>0?a.ajaxCalls.addEditFormAttribute(c):a.Tools.alert("Incorrect values","Please fulfill the name")},addEditAttribute:function(b,c){var d=function(){a("#formSettings #attributEditLine #attribName").val(b);a("#formSettings #attributEditLine #attribValue").val(c)},e=function(){if(confirm("Do you really want to delete the attribute "+
b+" ?")){a(this).parent().parent().next().remove();a(this).parent().parent().remove();var c={formFilename:a.ElementManager.getFormFilename(),name:b};a.ajaxCalls.deleteFormAttribute(c)}},f=null;a("#formSettings #elementAttributes").children().children().children(".attName").each(function(){a(this).text()==b&&(f=a(this).parent().parent())});if(f!=null)f.children().children(".attValue").html(c),f.children(".datasArea").unbind().click(d),f.children().children(".attribDelete").unbind().click(e);else{var g=
a.ElementManager.getDefAttribute();g.children(".datasArea").click(d);g.children().children(".attName").html(b);g.children().children(".attValue").html(c);g.children().children(".attribDelete").click(e);a("#formSettings #elementAttributes").append(g)}},getDefAttribute:function(){return a(a("#formSettings #attribDefaultLine").clone().html())},clearAttributes:function(){a("#formSettings #elementAttributes").children(".attrib").each(function(){a(this).next.remove();a(this).remove()})}};a.ElementManager.loadForm();
a.ElementManager.initFormAttributes()})(jQuery)});